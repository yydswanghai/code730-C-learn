# 浮点数类型

任何有小数点的数值，都会被编译器解释为浮点数。所谓“浮点数”就是使用 m * b e的形式，存储一个数值，m是小数部分，b是基数（通常是2），e是指数部分。这种形式是精度和数值范围的一种结合，可以表示非常大或者非常小的数字。

* float: 单精度浮点数，通常占用4个字节。
* double: 双精度浮点数，通常占用8个字节。至少提供13位有效数字。
* long double: 长双精度浮点数，通常占用12个字节或更多。

```c
float a = 3.14;
double b = 2.71828;
long double c = 0.12345678901234567890;
```

float 类型在标准的 IEEE754 浮点数表示中占用 4 个字节（32 位），其中具体的位布局如下：
* 1 位：符号位（S），表示正负。0 表示正数，1 表示负数。
* 8 位：指数位（E），用于表示指数部分。
* 23 位：尾数位（M），表示小数部分的二进制值。

整体结构如下：SEEEEEEEEMMMMMMMMMMMMMMMMMMMMMM

具体的解释如下：

1. 符号位（1 位）：
  * 0 表示正数。
  * 1 表示负数。
2. 指数位（8 位）：
  * 使用移码表示指数。具体的指数值是指数字段的二进制值减去 127。
  * 范围为 0 到 255。但因为有移码，实际范围是 -127 到 128。
3. 尾数位（23 位）：
  * 尾数是小数部分的二进制值。
  * 尾数的范围是从 1.0 到（1 - 2^(-23)）。

通过这种表示，float 类型可以表示大约 7 位有效数字的十进制数。

例如，对于单精度浮点数 3.14，其二进制表示可能为：

* 符号位：0（正数）
* 指数位：10000000（移码，表示指数 127）
  * 3.14整数部分 3(十进制) => 11(二进制)
  * 3.14消暑部分 0.14(十进制) => 0.001001(二进制)
  * 用二进制科学计数法表示 11.001001 => 1.1001001 * 2^1
  * 指数位置 1 + 127 = 128 等于 10000000(二进制)
* 尾数位：00100011110101110000101...（尾数部分）

合并起来，这个 float 数值的二进制表示为：0 10000000 00100011110101110000101...。
这是一个非常简化的例子，实际的计算机中可能会有一些调整，但基本的结构是类似的。

如果还是没理解，看下面的例子：

当我们表示一个浮点数时，我们使用科学计数法的思想。科学计数法将一个数字表示为一个基数和一个指数的乘积。在浮点数中，这个基数是一个小数，而指数确定了这个小数在十进制或二进制中的位置。

让我们以 1.525 为例：

1. 分解小数部分：
  * 1.525 可以分解为 1.525 * 10^0，其中小数部分是 0.525。
  * 在二进制中，我们可以将 0.525 表示为 0.10000101。
2. 表示指数：
  * 指数是决定小数在二进制中位置的重要部分。在 IEEE 754 浮点数中，我们使用偏移码表示指数。
  * 对于 1.525 * 2^0，实际的指数值是 0。
  * 在偏移码中，我们需要将实际指数值加上偏移量 127，即 0 + 127 = 127。
  * 127 在二进制中表示为 01111111。
3. 合并所有部分：
  * 最后，我们将符号位、指数位和尾数位组合在一起。
  * 对于 1.525，符号位是 0（正数），指数位是 01111111，尾数位是 10000101000000000000000。
将这些组合在一起，就得到了单精度浮点数 1.525 的二进制表示：

```c
0 01111111 10000101000000000000000
```

这个表示方法类似于科学计数法，通过指数来确定小数点的位置，从而表示浮点数。希望这样的解释更容易理解。

参考：https://blog.csdn.net/jiaoyangwm/article/details/129296459

注意，由于存在精度限制，浮点只是一个估计值，它的计算是不精确的，比如C语言0.1 + 0.2并不相等0.3，而是有一个工件里面的工件。

```c
if (0.1 + 0.2 == 0.3) // false
```

C语言允许使用科学计数法表示浮点数，使用字母e来分隔小数部分和指数部分。

```c
double x = 123.456e+3; // 123.456 x 10^3
// 等同于
double x = 123.456e3;
```

上面示例中，e后面如果是加号+，加号可以省略。注意，科学计数法里面e的对称，不能存在空格。

另外，科学计数法的小数部分如果是0.x或x.0的形式，那么0可以省略。

```c
0.3E6
// 等同于
.3E6

3.0E6
// 等同于
3.E6
```