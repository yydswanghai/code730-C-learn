## 什么是函数？

* 函数是一块代码，接收零个或多个参数，做一件事情，并返回零个或一个值
* 可以先想像成数学中的函数：y = f(x)

## 函数定义

```c
void sum(int a, int b)  // 函数头
{                       
  int c;                // 函数体
  c = a + b;            // 函数体
  printf("a+b=%d", c);  // 函数体
}                 
```

* void是返回类型，sum是函数名，圆括号里面是参数表

* 调用函数：函数名(参数值)
  * ()起到了表示函数调用的重要作用
  * 即使没有参数也需要()
  * 如果有参数，则需要给出正确的数量和顺序
  * 可以传递给函数的值是表达式的结果，这包括：
    * 字面量
    * 变量
    * 函数的返回值
    * 计算的结果
  * 这些值会被按照顺序依次用来初始化函数中的参数
* 函数知道每一次是哪里调用它，会返回到正确的地方

## 函数返回值

* 返回值
  * return 停止函数的执行，并送回一个值
    * return;
    * return 表达式;
* 没有返回值
  * void函数名(参数表)
  * 不能使用带值的return
  * 可以没有return
  * 调用的时候不能做返回值的赋值 

## 函数先后关系

* 像这样把sum()写在上面，是因为：
  * C的编译器自上而下顺序分析的代码

## 函数原型

* 函数头，以分号“;”结尾，就构成了函数的原型
* 函数原型的目的是告诉编译器这个函数长什么样
  * 名称
  * 参数(数据及类型)
  * 返回类型

## 参数传递

* 类型不匹配
  * 调用函数时给的值与参数的类型不匹配是C语言传统上最大的漏洞
  * 编译器总是悄悄替你把类型转换好，但是这很可能不是你所期望的
  * 后续的语言，C++/Java在这方便很严格

* 传过去的是什么？

## 传值

* 每个函数有自己的变量空间，参数也位于这个独立的空间中，和其他函数没有关系
* 过去，对于函数参数表中的参数，叫做“形式参数”，调用函数时给的值，叫做”实际参数”
* 由于容易让初学者误会实际参数就是实际在函数中进行计算的参数，误会调用函数的时候把变量而不是值传进去了，所以我们不建议继续用这种古老的方式老称呼它们。
* 我们认为，它们是参数和值的关系

## 本地变量

* 函数的每次运行，就产生了一个独立的变量空间，在这个空间中的变量，是函数的这次运行所独有的，称作本地变量
* 定义在函数内部的变量就是本地变量
* 参数也是本地变量

## 变量的生存期和作用域

* 生存期：什么时候这个变量开始出现了，到什么时候它消亡了
* 作用域：在（代码的）什么范围内可以访问这个变量（这个变量可以起作用）
* 对于本地变量，这两个问题的答案是统一的，大括号内——块

## 本地变量的规则

* 本地变量是定义在块内的
  * 它可以是定义在函数的块内
  * 也可以定义在语句的块内
  * 甚至可以随便拉一对大括号来定义变量
* 程序运行进入这个块之前，其中的变量不存在，离开这个块，其中的变量就消失了
* 块外面定义的变量在里面仍然有效
* 块里面定义了和外面同名的变量则掩盖了外面的
* 不能在一个块内定义同名的变量
* 本地变量不会被默认初始化

## 函数庶事

* 没有参数时：
  * void f(void) 还是 void f()
  * void f()，在传统C中，它表示函数的参数表未知，并不表示没有参数

## 逗号运算符

* 调用函数时的逗号和逗号运算符怎么区分？
* 调用函数时的圆括号里的逗号是标点符号，不是运算符
  * f(a, b) 标点符号，有两个参数
  * f((a, b)) 表示先做里面括号里的运算，仅一个参数

## 函数里的函数

* C语言不允许函数嵌套定义
  * int i,i,sum(int a, int b); 这是声明，可以的，但不建议
  * return (i);

* 关于mian
  * int main()也是一个函数
  * 要不要写成 int main(void)?
  * return的0有人看吗？
    * return 0; 表示这个程序正常结束
    * return任何非0的值，表示这个程序有错误
    * Windows：if error level 1...
    * Unix Bash：echo $?
    * Csh：echo $status

